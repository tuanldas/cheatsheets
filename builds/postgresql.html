<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-03-06T16:31:39.158487"><title>PostgreSQL | Help Instance</title><script type="application/json" id="virtual-toc-data">[{"id":"getting-started","level":0,"title":"Getting Started","anchor":"#getting-started"},{"id":"postgresql-working","level":0,"title":"PostgreSQL Working","anchor":"#postgresql-working"},{"id":"postgresql-commands","level":0,"title":"PostgreSQL Commands","anchor":"#postgresql-commands"},{"id":"miscellaneous","level":0,"title":"Miscellaneous","anchor":"#miscellaneous"},{"id":"also-see","level":0,"title":"Also see","anchor":"#also-see"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.css" rel="stylesheet"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="PostgreSQL | Help Instance"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Help Instance Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="postgresql.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="PostgreSQL | Help Instance"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "postgresql.html#webpage",
    "url": "postgresql.html",
    "name": "PostgreSQL | Help Instance",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "/#website",
    "url": "/",
    "name": "Help Instance Help"
}</script><!-- End Schema.org --></head><body data-id="PostgreSQL" data-main-title="PostgreSQL" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Help Instance  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="PostgreSQL" id="PostgreSQL.md">PostgreSQL</h1><section class="chapter"><h2 id="getting-started" data-toc="getting-started">Getting Started</h2><p id="1320406_2">Switch and connect</p><div class="code-block" data-lang="bash">
$ sudo -u postgres psql
</div><p id="1320406_4">List all databases</p><div class="code-block" data-lang="bash">
postgres=# \l
</div><p id="1320406_6">Connect to the database named postgres</p><div class="code-block" data-lang="bash">
postgres=# \c postgres
</div><p id="1320406_8">Disconnect</p><div class="code-block" data-lang="bash">
postgres=# \q
postgres=# \!
</div><section class="chapter"><h3 id="psql-commands" data-toc="psql-commands">psql commands</h3><div class="table-wrapper"><table class="wide" id="1320406_10"><thead><tr class="ijRowHead" id="1320406_11"><th id="1320406_12"><p>Option</p></th><th id="1320406_13"><p>Example</p></th><th id="1320406_14"><p>Description</p></th></tr></thead><tbody><tr id="1320406_15"><td id="1320406_16"><p><code class="code" id="1320406_17">[-d] &lt;database&gt;</code></p></td><td id="1320406_18"><p>psql -d mydb</p></td><td id="1320406_19"><p>Connecting to database</p></td></tr><tr id="1320406_20"><td id="1320406_21"><p><code class="code" id="1320406_22">-U</code></p></td><td id="1320406_23"><p>psql -U john mydb</p></td><td id="1320406_24"><p>Connecting as a specific user</p></td></tr><tr id="1320406_25"><td id="1320406_26"><p><code class="code" id="1320406_27">-h</code> <code class="code" id="1320406_28">-p</code></p></td><td id="1320406_29"><p>psql -h localhost -p 5432 mydb</p></td><td id="1320406_30"><p>Connecting to a host/port</p></td></tr><tr id="1320406_31"><td id="1320406_32"><p><code class="code" id="1320406_33">-U</code> <code class="code" id="1320406_34">-h</code> <code class="code" id="1320406_35">-p</code> <code class="code" id="1320406_36">-d</code></p></td><td id="1320406_37"><p>psql -U admin -h 192.168.1.5 -p 2506 -d mydb</p></td><td id="1320406_38"><p>Connect remote PostgreSQL</p></td></tr><tr id="1320406_39"><td id="1320406_40"><p><code class="code" id="1320406_41">-W</code></p></td><td id="1320406_42"><p>psql -W mydb</p></td><td id="1320406_43"><p>Force password</p></td></tr><tr id="1320406_44"><td id="1320406_45"><p><code class="code" id="1320406_46">-c</code></p></td><td id="1320406_47"><p>psql -c '\c postgres' -c '\dt'</p></td><td id="1320406_48"><p>Execute a SQL query or command</p></td></tr><tr id="1320406_49"><td id="1320406_50"><p><code class="code" id="1320406_51">-H</code></p></td><td id="1320406_52"><p>psql -c &quot;\l+&quot; -H postgres &gt; database.html</p></td><td id="1320406_53"><p>Generate HTML report</p></td></tr><tr id="1320406_54"><td id="1320406_55"><p><code class="code" id="1320406_56">-l</code></p></td><td id="1320406_57"><p>psql -l</p></td><td id="1320406_58"><p>List all databases</p></td></tr><tr id="1320406_59"><td id="1320406_60"><p><code class="code" id="1320406_61">-f</code></p></td><td id="1320406_62"><p>psql mydb -f file.sql</p></td><td id="1320406_63"><p>Execute commands from a file</p></td></tr><tr id="1320406_64"><td id="1320406_65"><p><code class="code" id="1320406_66">-V</code></p></td><td id="1320406_67"><p>psql -V</p></td><td id="1320406_68"><p>Print the psql version</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="getting-help" data-toc="getting-help">Getting help</h3><div class="table-wrapper"><table class="wide" id="1320406_69"><thead><tr class="ijRowHead" id="1320406_70"><th id="1320406_71"><p>-------------</p></th><th id="1320406_72"><p>--------------------------------</p></th></tr></thead><tbody><tr id="1320406_73"><td id="1320406_74"><p><code class="code" id="1320406_75">\h</code></p></td><td id="1320406_76"><p>Help on syntax of SQL commands</p></td></tr><tr id="1320406_77"><td id="1320406_78"><p><code class="code" id="1320406_79">\h</code> DELETE</p></td><td id="1320406_80"><p>DELETE SQL statement syntax</p></td></tr><tr id="1320406_81"><td id="1320406_82"><p><code class="code" id="1320406_83">?</code></p></td><td id="1320406_84"><p>List of PostgreSQL command</p></td></tr></tbody></table></div><p id="1320406_85">Run in PostgreSQL console</p></section></section><section class="chapter"><h2 id="postgresql-working" data-toc="postgresql-working">PostgreSQL Working</h2><section class="chapter"><h3 id="recon" data-toc="recon">Recon</h3><p id="1320406_86">Show version</p><div class="code-block" data-lang="none">
SHOW SERVER_VERSION;
</div><p id="1320406_88">Show system status</p><div class="code-block" data-lang="sql">
\conninfo
</div><p id="1320406_90">Show environmental variables</p><div class="code-block" data-lang="sql">
SHOW ALL;
</div><p id="1320406_92">List users</p><div class="code-block" data-lang="sql">
SELECT rolname FROM pg_roles;
</div><p id="1320406_94">Show current user</p><div class="code-block" data-lang="sql">
SELECT current_user;
</div><p id="1320406_96">Show current user's permissions</p><div class="code-block" data-lang="none">
\du
</div><p id="1320406_98">Show current database</p><div class="code-block" data-lang="sql">
SELECT current_database();
</div><p id="1320406_100">Show all tables in database</p><div class="code-block" data-lang="sql">
\dt
</div><p id="1320406_102">List functions</p><div class="code-block" data-lang="sql">
\df &lt;schema&gt;
</div></section><section class="chapter"><h3 id="databases" data-toc="databases">Databases</h3><p id="1320406_104">List databases</p><div class="code-block" data-lang="sql">
\l
</div><p id="1320406_106">Connect to database</p><div class="code-block" data-lang="sql">
\c &lt;database_name&gt;
</div><p id="1320406_108">Show current database</p><div class="code-block" data-lang="sql">
SELECT current_database();
</div><p id="1320406_110"><a href="http://www.postgresql.org/docs/current/static/sql-createdatabase.html" id="1320406_111" data-external="true" rel="noopener noreferrer">Create database</a></p><div class="code-block" data-lang="sql">
CREATE DATABASE &lt;database_name&gt; WITH OWNER &lt;username&gt;;
</div><p id="1320406_113"><a href="http://www.postgresql.org/docs/current/static/sql-dropdatabase.html" id="1320406_114" data-external="true" rel="noopener noreferrer">Drop database</a></p><div class="code-block" data-lang="sql">
DROP DATABASE IF EXISTS &lt;database_name&gt;;
</div><p id="1320406_116"><a href="http://www.postgresql.org/docs/current/static/sql-alterdatabase.html" id="1320406_117" data-external="true" rel="noopener noreferrer">Rename database</a></p><div class="code-block" data-lang="sql">
ALTER DATABASE &lt;old_name&gt; RENAME TO &lt;new_name&gt;;
</div></section><section class="chapter"><h3 id="tables_1" data-toc="tables_1">Tables</h3><p id="1320406_119">List tables, in current db</p><div class="code-block" data-lang="sql">
\dt

SELECT table_schema,table_name FROM information_schema.tables ORDER BY table_schema,table_name;
</div><p id="1320406_121">List tables, globally</p><div class="code-block" data-lang="sql">
\dt *.*.

SELECT * FROM pg_catalog.pg_tables
</div><p id="1320406_123">List table schema</p><div class="code-block" data-lang="sql">
\d &lt;table_name&gt;
\d+ &lt;table_name&gt;

SELECT column_name, data_type, character_maximum_length
FROM INFORMATION_SCHEMA.COLUMNS
WHERE table_name = '&lt;table_name&gt;';
</div><p id="1320406_125"><a href="http://www.postgresql.org/docs/current/static/sql-createtable.html" id="1320406_126" data-external="true" rel="noopener noreferrer">Create table</a></p><div class="code-block" data-lang="sql">
CREATE TABLE &lt;table_name&gt;(
  &lt;column_name&gt; &lt;column_type&gt;,
  &lt;column_name&gt; &lt;column_type&gt;
);
</div><p id="1320406_128">Create table, with an auto-incrementing primary key</p><div class="code-block" data-lang="sql">
CREATE TABLE &lt;table_name&gt; (
  &lt;column_name&gt; SERIAL PRIMARY KEY
);
</div><p id="1320406_130"><a href="http://www.postgresql.org/docs/current/static/sql-droptable.html" id="1320406_131" data-external="true" rel="noopener noreferrer">Delete table</a></p><div class="code-block" data-lang="sql">
DROP TABLE IF EXISTS &lt;table_name&gt; CASCADE;
</div></section><section class="chapter"><h3 id="permissions" data-toc="permissions">Permissions</h3><p id="1320406_133">Become the postgres user, if you have permission errors</p><div class="code-block" data-lang="bash">
sudo su - postgres
psql
</div><p id="1320406_135"><a href="http://www.postgresql.org/docs/current/static/sql-grant.html" id="1320406_136" data-external="true" rel="noopener noreferrer">Grant</a> all permissions on database</p><div class="code-block" data-lang="sql">
GRANT ALL PRIVILEGES ON DATABASE &lt;db_name&gt; TO &lt;user_name&gt;;
</div><p id="1320406_138">Grant connection permissions on database</p><div class="code-block" data-lang="sql">
GRANT CONNECT ON DATABASE &lt;db_name&gt; TO &lt;user_name&gt;;
</div><p id="1320406_140">Grant permissions on schema</p><div class="code-block" data-lang="sql">
GRANT USAGE ON SCHEMA public TO &lt;user_name&gt;;
</div><p id="1320406_142">Grant permissions to functions</p><div class="code-block" data-lang="sql">
GRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA public TO &lt;user_name&gt;;
</div><p id="1320406_144">Grant permissions to select, update, insert, delete, on a all tables</p><div class="code-block" data-lang="sql">
GRANT SELECT, UPDATE, INSERT ON ALL TABLES IN SCHEMA public TO &lt;user_name&gt;;
</div><p id="1320406_146">Grant permissions, on a table</p><div class="code-block" data-lang="sql">
GRANT SELECT, UPDATE, INSERT ON &lt;table_name&gt; TO &lt;user_name&gt;;
</div><p id="1320406_148">Grant permissions, to select, on a table</p><div class="code-block" data-lang="sql">
GRANT SELECT ON ALL TABLES IN SCHEMA public TO &lt;user_name&gt;;
</div></section><section class="chapter"><h3 id="columns" data-toc="columns">Columns</h3><p id="1320406_150"><a href="http://www.postgresql.org/docs/current/static/sql-altertable.html" id="1320406_151" data-external="true" rel="noopener noreferrer">Add column</a></p><div class="code-block" data-lang="sql">
ALTER TABLE &lt;table_name&gt; IF EXISTS
ADD &lt;column_name&gt; &lt;data_type&gt; [&lt;constraints&gt;];
</div><p id="1320406_153">Update column</p><div class="code-block" data-lang="sql">
ALTER TABLE &lt;table_name&gt; IF EXISTS
ALTER &lt;column_name&gt; TYPE &lt;data_type&gt; [&lt;constraints&gt;];
</div><p id="1320406_155">Delete column</p><div class="code-block" data-lang="sql">
ALTER TABLE &lt;table_name&gt; IF EXISTS
DROP &lt;column_name&gt;;
</div><p id="1320406_157">Update column to be an auto-incrementing primary key</p><div class="code-block" data-lang="sql">
ALTER TABLE &lt;table_name&gt;
ADD COLUMN &lt;column_name&gt; SERIAL PRIMARY KEY;
</div><p id="1320406_159">Insert into a table, with an auto-incrementing primary key</p><div class="code-block" data-lang="sql">
INSERT INTO &lt;table_name&gt;
VALUES (DEFAULT, &lt;value1&gt;);


INSERT INTO &lt;table_name&gt; (&lt;column1_name&gt;,&lt;column2_name&gt;)
VALUES ( &lt;value1&gt;,&lt;value2&gt; );
</div></section><section class="chapter"><h3 id="data" data-toc="data">Data</h3><p id="1320406_161"><a href="http://www.postgresql.org/docs/current/static/sql-select.html" id="1320406_162" data-external="true" rel="noopener noreferrer">Select</a> all data</p><div class="code-block" data-lang="sql">
SELECT * FROM &lt;table_name&gt;;
</div><p id="1320406_164">Read one row of data</p><div class="code-block" data-lang="sql">
SELECT * FROM &lt;table_name&gt; LIMIT 1;
</div><p id="1320406_166">Search for data</p><div class="code-block" data-lang="sql">
SELECT * FROM &lt;table_name&gt; WHERE &lt;column_name&gt; = &lt;value&gt;;
</div><p id="1320406_168"><a href="http://www.postgresql.org/docs/current/static/sql-insert.html" id="1320406_169" data-external="true" rel="noopener noreferrer">Insert</a> data</p><div class="code-block" data-lang="sql">
INSERT INTO &lt;table_name&gt; VALUES( &lt;value_1&gt;, &lt;value_2&gt; );
</div><p id="1320406_171"><a href="http://www.postgresql.org/docs/current/static/sql-update.html" id="1320406_172" data-external="true" rel="noopener noreferrer">Update</a> data</p><div class="code-block" data-lang="sql">
UPDATE &lt;table_name&gt;
SET &lt;column_1&gt; = &lt;value_1&gt;, &lt;column_2&gt; = &lt;value_2&gt;
WHERE &lt;column_1&gt; = &lt;value&gt;;
</div><p id="1320406_174"><a href="http://www.postgresql.org/docs/current/static/sql-delete.html" id="1320406_175" data-external="true" rel="noopener noreferrer">Delete</a> all data</p><div class="code-block" data-lang="sql">
DELETE FROM &lt;table_name&gt;;
</div><p id="1320406_177">Delete specific data</p><div class="code-block" data-lang="sql">
DELETE FROM &lt;table_name&gt;
WHERE &lt;column_name&gt; = &lt;value&gt;;
</div></section><section class="chapter"><h3 id="users" data-toc="users">Users</h3><p id="1320406_179">List roles</p><div class="code-block" data-lang="sql">
SELECT rolname FROM pg_roles;
</div><p id="1320406_181"><a href="http://www.postgresql.org/docs/current/static/sql-createuser.html" id="1320406_182" data-external="true" rel="noopener noreferrer">Create user</a></p><div class="code-block" data-lang="sql">
CREATE USER &lt;user_name&gt; WITH PASSWORD '&lt;password&gt;';
</div><p id="1320406_184"><a href="http://www.postgresql.org/docs/current/static/sql-dropuser.html" id="1320406_185" data-external="true" rel="noopener noreferrer">Drop user</a></p><div class="code-block" data-lang="sql">
DROP USER IF EXISTS &lt;user_name&gt;;
</div><p id="1320406_187"><a href="http://www.postgresql.org/docs/current/static/sql-alterrole.html" id="1320406_188" data-external="true" rel="noopener noreferrer">Alter</a> user password</p><div class="code-block" data-lang="sql">
ALTER ROLE &lt;user_name&gt; WITH PASSWORD '&lt;password&gt;';
</div></section><section class="chapter"><h3 id="schema" data-toc="schema">Schema</h3><p id="1320406_190">List schemas</p><div class="code-block" data-lang="sql">
\dn

SELECT schema_name FROM information_schema.schemata;

SELECT nspname FROM pg_catalog.pg_namespace;
</div><p id="1320406_192"><a href="http://www.postgresql.org/docs/current/static/sql-createschema.html" id="1320406_193" data-external="true" rel="noopener noreferrer">Create schema</a></p><div class="code-block" data-lang="sql">
CREATE SCHEMA IF NOT EXISTS &lt;schema_name&gt;;
</div><p id="1320406_195"><a href="http://www.postgresql.org/docs/current/static/sql-dropschema.html" id="1320406_196" data-external="true" rel="noopener noreferrer">Drop schema</a></p><div class="code-block" data-lang="sql">
DROP SCHEMA IF EXISTS &lt;schema_name&gt; CASCADE;
</div></section><section class="chapter"><h3 id="dates" data-toc="dates">Dates</h3><p id="1320406_198">Show <a href="https://www.postgresql.org/docs/15/functions-datetime.html#FUNCTIONS-DATETIME-CURRENT" id="1320406_199" data-external="true" rel="noopener noreferrer">current date</a> YYYY-MM-DD</p><div class="code-block" data-lang="sql">
SELECT current_date;
</div><p id="1320406_201">Calculate <a href="https://www.postgresql.org/docs/15/functions-datetime.html#:~:text=age%20(%20timestamp%2C%20timestamp%20)%20%E2%86%92%20interval" id="1320406_202" data-external="true" rel="noopener noreferrer">age</a> between two dates</p><div class="code-block" data-lang="sql">
SELECT age(timestamp, timestamp);
</div><p id="1320406_204">Show <a href="https://www.postgresql.org/docs/15/functions-datetime.html#FUNCTIONS-DATETIME-CURRENT" id="1320406_205" data-external="true" rel="noopener noreferrer">current time</a> with time zone</p><div class="code-block" data-lang="sql">
SELECT current_time;
</div><p id="1320406_207"><a href="https://www.postgresql.org/docs/15/functions-datetime.html#:~:text=make_date%20(%20year%20int%2C%20month%20int%2C%20day%20int%20)%20%E2%86%92%20date" id="1320406_208" data-external="true" rel="noopener noreferrer">Make</a> dates using integers</p><div class="code-block" data-lang="sql">
SELECT make_date(2021,03,25);
</div></section></section><section class="chapter"><h2 id="postgresql-commands" data-toc="postgresql-commands">PostgreSQL Commands</h2><section class="chapter"><h3 id="tables" data-toc="tables">Tables</h3><div class="table-wrapper"><table class="wide" id="1320406_210"><thead><tr class="ijRowHead" id="1320406_211"><th id="1320406_212"><p>------------------</p></th><th id="1320406_213"><p>---------------------------------</p></th></tr></thead><tbody><tr id="1320406_214"><td id="1320406_215"><p><code class="code" id="1320406_216">\d &lt;table&gt;</code></p></td><td id="1320406_217"><p>Describe table</p></td></tr><tr id="1320406_218"><td id="1320406_219"><p><code class="code" id="1320406_220">\d+ &lt;table&gt;</code></p></td><td id="1320406_221"><p>Describe table with details</p></td></tr><tr id="1320406_222"><td id="1320406_223"><p><code class="code" id="1320406_224">\dt</code></p></td><td id="1320406_225"><p>List tables from current schema</p></td></tr><tr id="1320406_226"><td id="1320406_227"><p><code class="code" id="1320406_228">\dt *.*</code></p></td><td id="1320406_229"><p>List tables from all schemas</p></td></tr><tr id="1320406_230"><td id="1320406_231"><p><code class="code" id="1320406_232">\dt &lt;schema&gt;.*</code></p></td><td id="1320406_233"><p>List tables for a schema</p></td></tr><tr id="1320406_234"><td id="1320406_235"><p><code class="code" id="1320406_236">\dp</code></p></td><td id="1320406_237"><p>List table access privileges</p></td></tr><tr id="1320406_238"><td id="1320406_239"><p><code class="code" id="1320406_240">\det[+]</code></p></td><td id="1320406_241"><p>List foreign tables</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="query-buffer" data-toc="query-buffer">Query buffer</h3><div class="table-wrapper"><table class="wide" id="1320406_242"><thead><tr class="ijRowHead" id="1320406_243"><th id="1320406_244"><p>--------------</p></th><th id="1320406_245"><p>------------------------------------</p></th></tr></thead><tbody><tr id="1320406_246"><td id="1320406_247"><p><code class="code" id="1320406_248">\e [FILE]</code></p></td><td id="1320406_249"><p>Edit the query buffer (or file)</p></td></tr><tr id="1320406_250"><td id="1320406_251"><p><code class="code" id="1320406_252">\ef [FUNC]</code></p></td><td id="1320406_253"><p>Edit function definition</p></td></tr><tr id="1320406_254"><td id="1320406_255"><p><code class="code" id="1320406_256">\p</code></p></td><td id="1320406_257"><p>Show the contents</p></td></tr><tr id="1320406_258"><td id="1320406_259"><p><code class="code" id="1320406_260">\r</code></p></td><td id="1320406_261"><p>Reset (clear) the query buffer</p></td></tr><tr id="1320406_262"><td id="1320406_263"><p><code class="code" id="1320406_264">\s [FILE]</code></p></td><td id="1320406_265"><p>Display history or save it to file</p></td></tr><tr id="1320406_266"><td id="1320406_267"><p><code class="code" id="1320406_268">\w FILE</code></p></td><td id="1320406_269"><p>Write query buffer to file</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="informational" data-toc="informational">Informational</h3><div class="table-wrapper"><table class="wide" id="1320406_270"><thead><tr class="ijRowHead" id="1320406_271"><th id="1320406_272"><p>-----------------</p></th><th id="1320406_273"><p>---------------------------------</p></th></tr></thead><tbody><tr id="1320406_274"><td id="1320406_275"><p><code class="code" id="1320406_276">\l[+]</code></p></td><td id="1320406_277"><p>List all databases</p></td></tr><tr id="1320406_278"><td id="1320406_279"><p><code class="code" id="1320406_280">\dn[S+]</code></p></td><td id="1320406_281"><p>List schemas</p></td></tr><tr id="1320406_282"><td id="1320406_283"><p><code class="code" id="1320406_284">\di[S+]</code></p></td><td id="1320406_285"><p>List indexes</p></td></tr><tr id="1320406_286"><td id="1320406_287"><p><code class="code" id="1320406_288">\du[+]</code></p></td><td id="1320406_289"><p>List roles</p></td></tr><tr id="1320406_290"><td id="1320406_291"><p><code class="code" id="1320406_292">\ds[S+]</code></p></td><td id="1320406_293"><p>List sequences</p></td></tr><tr id="1320406_294"><td id="1320406_295"><p><code class="code" id="1320406_296">\df[antw][S+]</code></p></td><td id="1320406_297"><p>List functions</p></td></tr><tr id="1320406_298"><td id="1320406_299"><p><code class="code" id="1320406_300">\deu[+]</code></p></td><td id="1320406_301"><p>List user mappings</p></td></tr><tr id="1320406_302"><td id="1320406_303"><p><code class="code" id="1320406_304">\dv[S+]</code></p></td><td id="1320406_305"><p>List views</p></td></tr><tr id="1320406_306"><td id="1320406_307"><p><code class="code" id="1320406_308">\dl</code></p></td><td id="1320406_309"><p>List large objects</p></td></tr><tr id="1320406_310"><td id="1320406_311"><p><code class="code" id="1320406_312">\dT[S+]</code></p></td><td id="1320406_313"><p>List data types</p></td></tr><tr id="1320406_314"><td id="1320406_315"><p><code class="code" id="1320406_316">\da[S]</code></p></td><td id="1320406_317"><p>List aggregates</p></td></tr><tr id="1320406_318"><td id="1320406_319"><p><code class="code" id="1320406_320">\db[+]</code></p></td><td id="1320406_321"><p>List tablespaces</p></td></tr><tr id="1320406_322"><td id="1320406_323"><p><code class="code" id="1320406_324">\dc[S+]</code></p></td><td id="1320406_325"><p>List conversions</p></td></tr><tr id="1320406_326"><td id="1320406_327"><p><code class="code" id="1320406_328">\dC[+]</code></p></td><td id="1320406_329"><p>List casts</p></td></tr><tr id="1320406_330"><td id="1320406_331"><p><code class="code" id="1320406_332">\ddp</code></p></td><td id="1320406_333"><p>List default privileges</p></td></tr><tr id="1320406_334"><td id="1320406_335"><p><code class="code" id="1320406_336">\dd[S]</code></p></td><td id="1320406_337"><p>Show object descriptions</p></td></tr><tr id="1320406_338"><td id="1320406_339"><p><code class="code" id="1320406_340">\dD[S+]</code></p></td><td id="1320406_341"><p>List domains</p></td></tr><tr id="1320406_342"><td id="1320406_343"><p><code class="code" id="1320406_344">\des[+]</code></p></td><td id="1320406_345"><p>List foreign servers</p></td></tr><tr id="1320406_346"><td id="1320406_347"><p><code class="code" id="1320406_348">\dew[+]</code></p></td><td id="1320406_349"><p>List foreign-data wrappers</p></td></tr><tr id="1320406_350"><td id="1320406_351"><p><code class="code" id="1320406_352">\dF[+]</code></p></td><td id="1320406_353"><p>List text search configurations</p></td></tr><tr id="1320406_354"><td id="1320406_355"><p><code class="code" id="1320406_356">\dFd[+]</code></p></td><td id="1320406_357"><p>List text search dictionaries</p></td></tr><tr id="1320406_358"><td id="1320406_359"><p><code class="code" id="1320406_360">\dFp[+]</code></p></td><td id="1320406_361"><p>List text search parsers</p></td></tr><tr id="1320406_362"><td id="1320406_363"><p><code class="code" id="1320406_364">\dFt[+]</code></p></td><td id="1320406_365"><p>List text search templates</p></td></tr><tr id="1320406_366"><td id="1320406_367"><p><code class="code" id="1320406_368">\dL[S+]</code></p></td><td id="1320406_369"><p>List procedural languages</p></td></tr><tr id="1320406_370"><td id="1320406_371"><p><code class="code" id="1320406_372">\do[S]</code></p></td><td id="1320406_373"><p>List operators</p></td></tr><tr id="1320406_374"><td id="1320406_375"><p><code class="code" id="1320406_376">\dO[S+]</code></p></td><td id="1320406_377"><p>List collations</p></td></tr><tr id="1320406_378"><td id="1320406_379"><p><code class="code" id="1320406_380">\drds</code></p></td><td id="1320406_381"><p>List per-database role settings</p></td></tr><tr id="1320406_382"><td id="1320406_383"><p><code class="code" id="1320406_384">\dx[+]</code></p></td><td id="1320406_385"><p>List extensions</p></td></tr></tbody></table></div><p id="1320406_386"><code class="code" id="1320406_387">S</code>: show system objects, <code class="code" id="1320406_388">+</code>: additional detail</p></section><section class="chapter"><h3 id="connection" data-toc="connection">Connection</h3><div class="table-wrapper"><table class="wide" id="1320406_389"><thead><tr class="ijRowHead" id="1320406_390"><th id="1320406_391"><p>------------------------</p></th><th id="1320406_392"><p>-----------------------------</p></th></tr></thead><tbody><tr id="1320406_393"><td id="1320406_394"><p><code class="code" id="1320406_395">\c [DBNAME]</code></p></td><td id="1320406_396"><p>Connect to new database</p></td></tr><tr id="1320406_397"><td id="1320406_398"><p><code class="code" id="1320406_399">\encoding [ENCODING]</code></p></td><td id="1320406_400"><p>Show or set client encoding</p></td></tr><tr id="1320406_401"><td id="1320406_402"><p><code class="code" id="1320406_403">\password [USER]</code></p></td><td id="1320406_404"><p>Change the password</p></td></tr><tr id="1320406_405"><td id="1320406_406"><p><code class="code" id="1320406_407">\conninfo</code></p></td><td id="1320406_408"><p>Display information</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="formatting" data-toc="formatting">Formatting</h3><div class="table-wrapper"><table class="wide" id="1320406_409"><thead><tr class="ijRowHead" id="1320406_410"><th id="1320406_411"><p>---------------</p></th><th id="1320406_412"><p>--------------------------------------------</p></th></tr></thead><tbody><tr id="1320406_413"><td id="1320406_414"><p><code class="code" id="1320406_415">\a</code></p></td><td id="1320406_416"><p>Toggle between unaligned and aligned</p></td></tr><tr id="1320406_417"><td id="1320406_418"><p><code class="code" id="1320406_419">\C [STRING]</code></p></td><td id="1320406_420"><p>Set table title, or unset if none</p></td></tr><tr id="1320406_421"><td id="1320406_422"><p><code class="code" id="1320406_423">\f [STRING]</code></p></td><td id="1320406_424"><p>Show or set field separator for unaligned</p></td></tr><tr id="1320406_425"><td id="1320406_426"><p><code class="code" id="1320406_427">\H</code></p></td><td id="1320406_428"><p>Toggle HTML output mode</p></td></tr><tr id="1320406_429"><td id="1320406_430"><p><code class="code" id="1320406_431">\t [on | off]</code></p></td><td id="1320406_432"><p>Show only rows</p></td></tr><tr id="1320406_433"><td id="1320406_434"><p><code class="code" id="1320406_435">\T [STRING]</code></p></td><td id="1320406_436"><p>Set or unset HTML &lt;table&gt; tag attributes</p></td></tr><tr id="1320406_437"><td id="1320406_438"><p><code class="code" id="1320406_439">\x [on | off]</code></p></td><td id="1320406_440"><p>Toggle expanded output</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="input-output" data-toc="input-output">Input/Output</h3><div class="table-wrapper"><table class="wide" id="1320406_441"><thead><tr class="ijRowHead" id="1320406_442"><th id="1320406_443"><p>-------------------</p></th><th id="1320406_444"><p>-------------------------------------------------------------</p></th></tr></thead><tbody><tr id="1320406_445"><td id="1320406_446"><p><code class="code" id="1320406_447">\copy ...</code></p></td><td id="1320406_448"><p>Import/export table. <span class="emphasis" id="1320406_449">See also:</span> <a href="#import-export-csv" id="1320406_450" data-tooltip="Export table into CSV file">copy</a></p></td></tr><tr id="1320406_451"><td id="1320406_452"><p><code class="code" id="1320406_453">\echo [STRING]</code></p></td><td id="1320406_454"><p>Print string</p></td></tr><tr id="1320406_455"><td id="1320406_456"><p><code class="code" id="1320406_457">\i FILE</code></p></td><td id="1320406_458"><p>Execute file</p></td></tr><tr id="1320406_459"><td id="1320406_460"><p><code class="code" id="1320406_461">\o [FILE]</code></p></td><td id="1320406_462"><p>Export all results to file</p></td></tr><tr id="1320406_463"><td id="1320406_464"><p><code class="code" id="1320406_465">\qecho [STRING]</code></p></td><td id="1320406_466"><p>String to output stream</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="variables" data-toc="variables">Variables</h3><div class="table-wrapper"><table class="wide" id="1320406_467"><thead><tr class="ijRowHead" id="1320406_468"><th id="1320406_469"><p>-----------------------</p></th><th id="1320406_470"><p>-----------------------------------------------</p></th></tr></thead><tbody><tr id="1320406_471"><td id="1320406_472"><p><code class="code" id="1320406_473">\prompt [TEXT] NAME</code></p></td><td id="1320406_474"><p>Set variable</p></td></tr><tr id="1320406_475"><td id="1320406_476"><p><code class="code" id="1320406_477">\set [NAME [VALUE]]</code></p></td><td id="1320406_478"><p>Set variable <span class="emphasis" id="1320406_479">(or list all if no parameters)</span></p></td></tr><tr id="1320406_480"><td id="1320406_481"><p><code class="code" id="1320406_482">\unset NAME</code></p></td><td id="1320406_483"><p>Delete variable</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="misc" data-toc="misc">Misc</h3><div class="table-wrapper"><table class="wide" id="1320406_484"><thead><tr class="ijRowHead" id="1320406_485"><th id="1320406_486"><p>----------------</p></th><th id="1320406_487"><p>----------------------</p></th></tr></thead><tbody><tr id="1320406_488"><td id="1320406_489"><p><code class="code" id="1320406_490">\cd [DIR]</code></p></td><td id="1320406_491"><p>Change the directory</p></td></tr><tr id="1320406_492"><td id="1320406_493"><p><code class="code" id="1320406_494">\timing [on | off]</code></p></td><td id="1320406_495"><p>Toggle timing</p></td></tr><tr id="1320406_496"><td id="1320406_497"><p><code class="code" id="1320406_498">! [COMMAND]</code></p></td><td id="1320406_499"><p>Execute in shell</p></td></tr><tr id="1320406_500"><td id="1320406_501"><p><code class="code" id="1320406_502">! ls -l</code></p></td><td id="1320406_503"><p>List all in shell</p></td></tr></tbody></table></div></section><section class="chapter"><h3 id="large-objects" data-toc="large-objects">Large Objects</h3><ul class="list _ul" id="1320406_504"><li class="list__item" id="1320406_505"><p><code class="code" id="1320406_506">\lo_export LOBOID FILE</code></p></li><li class="list__item" id="1320406_507"><p><code class="code" id="1320406_508">\lo_import FILE [COMMENT]</code></p></li><li class="list__item" id="1320406_509"><p><code class="code" id="1320406_510">\lo_list</code></p></li><li class="list__item" id="1320406_511"><p><code class="code" id="1320406_512">\lo_unlink LOBOID</code></p></li></ul></section></section><section class="chapter"><h2 id="miscellaneous" data-toc="miscellaneous">Miscellaneous</h2><section class="chapter"><h3 id="backup" data-toc="backup">Backup</h3><p id="1320406_513">Use pg_dumpall to backup all databases</p><div class="code-block" data-lang="bash">
$ pg_dumpall -U postgres &gt; all.sql
</div><p id="1320406_515">Use pg_dump to backup a database</p><div class="code-block" data-lang="bash">
$ pg_dump -d mydb -f mydb_backup.sql
</div><ul class="list _ul" id="1320406_517"><li class="list__item" id="1320406_518"><p>&nbsp; <code class="code" id="1320406_519">-a</code> &nbsp; Dump only the data, not the schema</p></li><li class="list__item" id="1320406_520"><p>&nbsp; <code class="code" id="1320406_521">-s</code> &nbsp; Dump only the schema, no data</p></li><li class="list__item" id="1320406_522"><p>&nbsp; <code class="code" id="1320406_523">-c</code> &nbsp; Drop database before recreating</p></li><li class="list__item" id="1320406_524"><p>&nbsp; <code class="code" id="1320406_525">-C</code> &nbsp; Create database before restoring</p></li><li class="list__item" id="1320406_526"><p>&nbsp; <code class="code" id="1320406_527">-t</code> &nbsp; Dump the named table(s) only</p></li><li class="list__item" id="1320406_528"><p>&nbsp; <code class="code" id="1320406_529">-F</code> &nbsp; Format (<code class="code" id="1320406_530">c</code>: custom, <code class="code" id="1320406_531">d</code>: directory, <code class="code" id="1320406_532">t</code>: tar)</p></li></ul><p id="1320406_533">Use <code class="code" id="1320406_534">pg_dump -?</code> to get the full list of options</p></section><section class="chapter"><h3 id="restore" data-toc="restore">Restore</h3><p id="1320406_535">Restore a database with psql</p><div class="code-block" data-lang="bash">
$ psql -U user mydb &lt; mydb_backup.sql
</div><p id="1320406_537">Restore a database with pg_restore</p><div class="code-block" data-lang="bash">
$ pg_restore -d mydb mydb_backup.sql -c
</div><ul class="list _ul" id="1320406_539"><li class="list__item" id="1320406_540"><p>&nbsp; <code class="code" id="1320406_541">-U</code> &nbsp; Specify a database user</p></li><li class="list__item" id="1320406_542"><p>&nbsp; <code class="code" id="1320406_543">-c</code> &nbsp; Drop database before recreating</p></li><li class="list__item" id="1320406_544"><p>&nbsp; <code class="code" id="1320406_545">-C</code> &nbsp; Create database before restoring</p></li><li class="list__item" id="1320406_546"><p>&nbsp; <code class="code" id="1320406_547">-e</code> &nbsp; Exit if an error has encountered</p></li><li class="list__item" id="1320406_548"><p>&nbsp; <code class="code" id="1320406_549">-F</code> &nbsp; Format (<code class="code" id="1320406_550">c</code>: custom, <code class="code" id="1320406_551">d</code>: directory, <code class="code" id="1320406_552">t</code>: tar, <code class="code" id="1320406_553">p</code>: plain text sql(default))</p></li></ul><p id="1320406_554">Use <code class="code" id="1320406_555">pg_restore -?</code> to get the full list of options</p></section><section class="chapter"><h3 id="remote-access" data-toc="remote-access">Remote access</h3><p id="1320406_556">Get location of postgresql.conf</p><div class="code-block" data-lang="bash">
$ psql -U postgres -c 'SHOW config_file'
</div><p id="1320406_558">Append to postgresql.conf</p><div class="code-block" data-lang="bash">
listen_addresses = '*'
</div><p id="1320406_560">Append to pg_hba.conf (Same location as postgresql.conf)</p><div class="code-block" data-lang="bash">
host  all  all  0.0.0.0/0  md5
host  all  all  ::/0       md5
</div><p id="1320406_562">Restart PostgreSQL server</p><div class="code-block" data-lang="bash">
$ sudo systemctl restart postgresql
</div></section><section class="chapter"><h3 id="import-export-csv" data-toc="import-export-csv">Import/Export CSV</h3><p id="1320406_564">Export table into CSV file</p><div class="code-block" data-lang="bash">
\copy table TO '&lt;path&gt;' CSV
\copy table(col1,col1) TO '&lt;path&gt;' CSV
\copy (SELECT...) TO '&lt;path&gt;' CSV
</div><p id="1320406_566">Import CSV file into table</p><div class="code-block" data-lang="bash">
\copy table FROM '&lt;path&gt;' CSV
\copy table(col1,col1) FROM '&lt;path&gt;' CSV
</div><p id="1320406_568">See also: <a href="https://www.postgresql.org/docs/current/sql-copy.html" id="1320406_569" data-external="true" rel="noopener noreferrer">Copy</a></p></section></section><section class="chapter"><h2 id="also-see" data-toc="also-see">Also see</h2><ul class="list _ul" id="1320406_570"><li class="list__item" id="1320406_571"><p><a href="https://gist.github.com/apolloclark/ea5466d5929e63043dcf#posgres-cheatsheet" id="1320406_572" data-external="true" rel="noopener noreferrer">Posgres-cheatsheet</a> <span class="emphasis" id="1320406_573">(gist.github.com)</span></p></li></ul></section><div class="last-modified">Last modified: 06 March 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="http-status-code.html" class="navigation-links__prev">HTTP Status Code</a><a href="vim.html" class="navigation-links__next">Vim</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.js"></script></body></html>